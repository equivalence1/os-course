\begin{frame}
\frametitle{Paxos}
\begin{itemize}
  \item Paxos - алгоритм достижения консенсуса в асинхронных системах с падениями:
    \begin{itemize}
      \item как известно алгоритма удовлетворяющего всем 3 свойствам не существует;
      \item paxos не гарантирует завершения за конечное число шагов;
      \item paxos гарантирует отсутствие deadlock-ов, т. е. если все узлы вернутся в строй, консенсус будет достигнут;
      \item на практике ситуация, в которой paxos "зависнет" очень редкие;
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Paxos}
\begin{itemize}
  \item Paxos состоит из одного или более раундов:
    \begin{itemize}
      \item у каждого раунда есть лидер - тот кто раунд начал;
      \item каждый раунд имеет уникальный идентификатор;
      \item состоит из 3 этапов;
      \item консенсус достигнут, если лидер успешно завершает свой раунд;
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Paxos}
\begin{itemize}
  \item Этап первый - просим принять нас в качестве лидера:
    \begin{itemize}
      \item выбираем уникальный идентификатор раунда;
      \item связываемся с другими процессами и посылаем им идентификатор
      \item в ответ получаем два значения:
        \begin{itemize}
          \item максимальный номер раунда, для которого процесс принял значение (если принял);
          \item и значение, которое он принял в этом раунде;
        \end{itemize}
      \item нам достаточно ответ от большинства
        \begin{itemize}
          \item если никто из них не видел большего идентификатора - мы лидер;
          \item иначе можно на этом и закончить;
        \end{itemize}
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Paxos}
\begin{itemize}
  \item Этап второй - предложение (значения):
    \begin{itemize}
      \item лидер должен выбрать подходящее значение:
        \begin{itemize}
          \item у нас есть какое-то значение, иначе зачем бы нам запускать голосование;
          \item кроме того процессы могли прислать значения, на которые они согласились в одном из предыдущих раундов;
          \item если наше значение единственное, то выбираем его, в противном случае выбираем самое "новое" значение из присланных;
        \end{itemize}
      \item посылаем выбранное значение процессам, ждем подтверждения от большинства:
        \begin{itemize}
          \item процесс посылает подтверждение, если не видел большего идентификатора раунда;
          \item процесс также сохраняет полученное значение;
          \item процесс посылает отказ, если он видел больший идентификатор;
        \end{itemize}
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Paxos}
\begin{itemize}
  \item Этап третий - коммит:
    \begin{itemize}
      \item мы получили подтверждение от большинства, консенсус достигнут;
      \item осталось сообщить об этом заинтересованным сторонам;
    \end{itemize}
  \item строго говоря консенсус достигнут несколько раньше:
    \begin{itemize}
      \item как только большинство процессов сохранили себе значение;
      \item просто не все (включая лидера раунда) об этом знают;
    \end{itemize}
\end{itemize}
\end{frame}
